#!/usr/bin/expect -f
#
# This Expect script was generated by autoexpect on Tue Jul  4 13:43:56 2017
# Expect and autoexpect were both written by Don Libes, NIST.
#
# Note that autoexpect does not guarantee a working script.  It
# necessarily has to guess about certain things.  Two reasons a script
# might fail are:
#
# 1) timing - A surprising number of programs (rn, ksh, zsh, telnet,
# etc.) and devices discard or ignore keystrokes that arrive "too
# quickly" after prompts.  If you find your new script hanging up at
# one spot, try adding a short sleep just before the previous send.
# Setting "force_conservative" to 1 (see below) makes Expect do this
# automatically - pausing briefly before sending each character.  This
# pacifies every program I know of.  The -c flag makes the script do
# this in the first place.  The -C flag allows you to define a
# character to toggle this mode off and on.

set force_conservative 0  ;# set to 1 to force conservative mode even if
			  ;# script wasn't run conservatively originally
if {$force_conservative} {
	set send_slow {1 .1}
	proc send {ignore arg} {
		sleep .1
		exp_send -s -- $arg
	}
}

#
# 2) differing output - Some programs produce different output each time
# they run.  The "date" command is an obvious example.  Another is
# ftp, if it produces throughput statistics at the end of a file
# transfer.  If this causes a problem, delete these patterns or replace
# them with wildcards.  An alternative is to use the -p flag (for
# "prompt") which makes Expect only look for the last line of output
# (i.e., the prompt).  The -P flag allows you to define a character to
# toggle this mode off and on.
#
# Read the man page for more info.
#
# -Don


set timeout -1
spawn $env(SHELL)
match_max 100000
expect -exact "root@raspberrypi:/home/pi/install# "
send -- "raspi-con	"
expect -exact "fig "
send -- "\r"
expect -exact "\r
\[?1049h\[1;24r\[4l\[?25l(B\[m\[37m\[40m\[1;24r\[H\[2J\[1;1H\[1m\[37m\[44m                                                                                \[2;1H                                                                                \[3;1H                                                                                \[4;1H                                                                                \[5;1H                                                                                \[6;1H                                                                                \[7;1H                                                                                \[8;1H                                                                                \[9;1H                                                                                \[10;1H                                                                                \[11;1H                                                                                \[12;1H                                                                                \[13;1H                                                                                \[14;1H                                                                                \[15;1H                                                                                \[16;1H                                                                                \[17;1H                                                                                \[18;1H                                                                                \[19;1H                                                                                \[20;1H                                                                                \[21;1H                                                                                \[22;1H                                                                                \[23;1H                                                                                \[24;1H                                                                               \[24;79H \[4h \[4l\[1;1H


(B\[m\[30m\[47m┌─────────┤ \[31mRaspberry Pi Software Configuration Tool (raspi-config)\[30m ├──────────┐\[5;1H│                                                                              │\[6;1H│    \[37m\[41m1 Change User Password           Change password for the default u\[30m\[47m        │\[7;1H│    2 Hostname                       Set the visible name for this Pi         │\[8;1H│    3 Boot Options                   Configure options for start-up           │\[9;1H│    4 Localisation Options           Set up language and regional sett        │\[10;1H│    5 Interfacing Options            Configure connections to peripher        │\[11;1H│    6 Overclock                      Configure overclocking for your P        │\[12;1H│    7 Advanced Options               Configure advanced settings              │\[13;1H│    8 Update                         Update this tool to the latest ve        │\[14;1H│    9 About raspi-config             Information about this configurat        │\[15;1H│                                                                              │\[16;1H│                                                                              │\[17;1H│                                                                              │\[18;1H│                     <Select>                     <Finish>                    │\[19;1H│                                                                              │\[20;1H└──────────────────────────────────────────────────────────────────────────────┘\[21;2H\[1m\[37m\[40m                                                                               \[6;6H"
send -- "\[B"
expect -exact "(B\[m\[30m\[47m1 Change User Password           Change password for the default u\[7;6H\[37m\[41m2 Hostname                       Set the visible name for this Pi \[7;6H"
send -- "\[B"
expect -exact "\[30m\[47m2 Hostname                       Set the visible name for this Pi \[8;6H\[37m\[41m3 Boot Options                   Configure options for start-up   \[8;6H"
send -- "\[B"
expect -exact "\[30m\[47m3 Boot Options                   Configure options for start-up   \[9;6H\[37m\[41m4 Localisation Options           Set up language and regional sett\[9;6H"
send -- "\[B"
expect -exact "\[30m\[47m4 Localisation Options           Set up language and regional sett\[10;6H\[37m\[41m5 Interfacing Options            Configure connections to peripher\[10;6H"
send -- "\r"
expect -exact "\[?12l\[?25h\[24;1H\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;24r\[4l\[?25l(B\[m\[37m\[40m\[1;24r\[H\[2J\[1;1H\[1m\[37m\[44m                                                                                \[2;1H                                                                                \[3;1H                                                                                \[4;1H                                                                                \[5;1H                                                                                \[6;1H                                                                                \[7;1H                                                                                \[8;1H                                                                                \[9;1H                                                                                \[10;1H                                                                                \[11;1H                                                                                \[12;1H                                                                                \[13;1H                                                                                \[14;1H                                                                                \[15;1H                                                                                \[16;1H                                                                                \[17;1H                                                                                \[18;1H                                                                                \[19;1H                                                                                \[20;1H                                                                                \[21;1H                                                                                \[22;1H                                                                                \[23;1H                                                                                \[24;1H                                                                               \[24;79H \[4h \[4l\[1;1H


(B\[m\[30m\[47m┌─────────┤ \[31mRaspberry Pi Software Configuration Tool (raspi-config)\[30m ├──────────┐\[5;1H│                                                                              │\[6;1H│    \[37m\[41mP1 Camera                        Enable/Disable connection to the \[30m\[47m        │\[7;1H│    P2 SSH                           Enable/Disable remote command lin        │\[8;1H│    P3 VNC                           Enable/Disable graphical remote a        │\[9;1H│    P4 SPI                           Enable/Disable automatic loading         │\[10;1H│    P5 I2C                           Enable/Disable automatic loading         │\[11;1H│    P6 Serial                        Enable/Disable shell and kernel m        │\[12;1H│    P7 1-Wire                        Enable/Disable one-wire interface        │\[13;1H│    P8 Remote GPIO                   Enable/Disable remote access to G        │\[14;1H│                                                                              │\[15;1H│                                                                              │\[16;1H│                                                                              │\[17;1H│                                                                              │\[18;1H│                     <Select>                     <Back>                      │\[19;1H│                                                                              │\[20;1H└──────────────────────────────────────────────────────────────────────────────┘\[21;2H\[1m\[37m\[40m                                                                               \[6;6H"
send -- "\[B"
expect -exact "(B\[m\[30m\[47mP1 Camera                        Enable/Disable connection to the \[7;6H\[37m\[41mP2 SSH                           Enable/Disable remote command lin\[7;6H"
send -- "\r"
expect -exact "\[?12l\[?25h\[24;1H\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;24r\[4l\[?25l(B\[m\[37m\[40m\[1;24r\[H\[2J\[1;1H\[1m\[37m\[44m                                                                                \[2;1H                                                                                \[3;1H                                                                                \[4;1H                                                                                \[5;1H                                                                                \[6;1H                                                                                \[7;1H                                                                                \[8;1H                                                                                \[9;1H                                                                                \[10;1H                                                                                \[11;1H                                                                                \[12;1H                                                                                \[13;1H                                                                                \[14;1H                                                                                \[15;1H                                                                                \[16;1H                                                                                \[17;1H                                                                                \[18;1H                                                                                \[19;1H                                                                                \[20;1H                                                                                \[21;1H                                                                                \[22;1H                                                                                \[23;1H                                                                                \[24;1H                                                                               \[24;79H \[4h \[4l\[1;1H\[3;11H(B\[m\[30m\[47m┌──────────────────────────────────────────────────────────┐\[4;11H│                                                          │\[1m\[37m\[40m \[5;11H(B\[m\[30m\[47m│ Would you like the SSH server to be enabled?             │\[1m\[37m\[40m \[6;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[7;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[8;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[9;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[10;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[11;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[12;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[13;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[14;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[15;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[16;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[17;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[18;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[19;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[20;11H(B\[m\[30m\[47m│               \[37m\[41m<Yes>\[30m\[47m                  <No>                │\[1m\[37m\[40m \[21;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[22;11H(B\[m\[30m\[47m└──────────────────────────────────────────────────────────┘\[1m\[37m\[40m \[23;12H                                                            \[20;28H"
send -- "\r"
expect -exact "\[?12l\[?25h\r



(B\[m\[37m\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;24r\[4l\[?25l(B\[m\[37m\[40m\[1;24r\[H\[2J\[1;1H\[1m\[37m\[44m                                                                                \[2;1H                                                                                \[3;1H                                                                                \[4;1H                                                                                \[5;1H                                                                                \[6;1H                                                                                \[7;1H                                                                                \[8;1H                                                                                \[9;1H                                                                                \[10;1H                                                                                \[11;1H                                                                                \[12;1H                                                                                \[13;1H                                                                                \[14;1H                                                                                \[15;1H                                                                                \[16;1H                                                                                \[17;1H                                                                                \[18;1H                                                                                \[19;1H                                                                                \[20;1H                                                                                \[21;1H                                                                                \[22;1H                                                                                \[23;1H                                                                                \[24;1H                                                                               \[24;79H \[4h \[4l\[1;1H\[3;11H(B\[m\[30m\[47m┌──────────────────────────────────────────────────────────┐\[4;11H│                                                          │\[1m\[37m\[40m \[5;11H(B\[m\[30m\[47m│ The SSH server is enabled                                │\[1m\[37m\[40m \[6;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[7;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[8;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[9;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[10;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[11;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[12;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[13;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[14;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[15;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[16;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[17;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[18;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[19;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[20;11H(B\[m\[30m\[47m│                          \[37m\[41m<Ok>\[30m\[47m                            │\[1m\[37m\[40m \[21;11H(B\[m\[30m\[47m│                                                          │\[1m\[37m\[40m \[22;11H(B\[m\[30m\[47m└──────────────────────────────────────────────────────────┘\[1m\[37m\[40m \[23;12H                                                            \[20;39H"
send -- "\r"
expect -exact "\[?12l\[?25h\r



(B\[m\[37m\[40m(B\[m\[39;49m\r\[K\r\[?1049l\[?1049h\[1;24r\[4l\[?25l(B\[m\[37m\[40m\[1;24r\[H\[2J\[1;1H\[1m\[37m\[44m                                                                                \[2;1H                                                                                \[3;1H                                                                                \[4;1H                                                                                \[5;1H                                                                                \[6;1H                                                                                \[7;1H                                                                                \[8;1H                                                                                \[9;1H                                                                                \[10;1H                                                                                \[11;1H                                                                                \[12;1H                                                                                \[13;1H                                                                                \[14;1H                                                                                \[15;1H                                                                                \[16;1H                                                                                \[17;1H                                                                                \[18;1H                                                                                \[19;1H                                                                                \[20;1H                                                                                \[21;1H                                                                                \[22;1H                                                                                \[23;1H                                                                                \[24;1H                                                                               \[24;79H \[4h \[4l\[1;1H


(B\[m\[30m\[47m┌─────────┤ \[31mRaspberry Pi Software Configuration Tool (raspi-config)\[30m ├──────────┐\[5;1H│                                                                              │\[6;1H│    \[37m\[41m1 Change User Password           Change password for the default u\[30m\[47m        │\[7;1H│    2 Hostname                       Set the visible name for this Pi         │\[8;1H│    3 Boot Options                   Configure options for start-up           │\[9;1H│    4 Localisation Options           Set up language and regional sett        │\[10;1H│    5 Interfacing Options            Configure connections to peripher        │\[11;1H│    6 Overclock                      Configure overclocking for your P        │\[12;1H│    7 Advanced Options               Configure advanced settings              │\[13;1H│    8 Update                         Update this tool to the latest ve        │\[14;1H│    9 About raspi-config             Information about this configurat        │\[15;1H│                                                                              │\[16;1H│                                                                              │\[17;1H│                                                                              │\[18;1H│                     <Select>                     <Finish>                    │\[19;1H│                                                                              │\[20;1H└──────────────────────────────────────────────────────────────────────────────┘\[21;2H\[1m\[37m\[40m                                                                               \[6;6H"
send -- "\[C"
expect -exact "(B\[m\[37m\[44m1 Change User Password           Change password for the default u\[18;23H\[41m<Select>\[18;24H"
send -- "\[C"
expect -exact "\[30m\[47m<Select>\[21C\[37m\[41m<Finish>\[18;53H"
send -- "\r"
expect -exact "\[?12l\[?25h\[24;1H\[40m(B\[m\[39;49m\r\[K\r\[?1049lroot@raspberrypi:/home/pi/install# "
send -- "exit\r"
expect eof
